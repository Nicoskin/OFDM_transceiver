#include "../ofdm_mod.h"
#include "../fft/fft.h"
#include <iostream>

int main() {
    // Параметры OFDM
    int N_FFT = 128;
    int G_subcar = 55;
    int N_PILOTS = 6;
    int CP_LEN = 16;

    // Создание объекта OFDM
    OFDM ofdm(N_FFT, G_subcar, N_PILOTS, CP_LEN);

    // Пример входных данных (комплексные значения квадратур)
    std::vector<std::vector<std::complex<double>>> input_matrix = {
        {{(0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (-0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (-0.707, 0.707), (-0.707, -0.707), (0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, -0.707), (0.707, -0.707), (0.707, 0.707), (0.707, 0.707), (-0.707, 0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (-0.707, 0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (0.707, 0.707), (0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (0.707, -0.707), (0.707, 0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, 0.707), (0.707, 0.707), (0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (0.707, 0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, 0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, -0.707), (0.707, 0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (-0.707, 0.707), (-0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, -0.707), (0.707, 0.707), (0.707, 0.707), (-0.707, 0.707), (-0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707), (-0.707, 0.707), (0.707, 0.707), (-0.707, -0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (-0.707, -0.707), (-0.707, -0.707), (0.707, 0.707), (0.707, 0.707), (0.707, 0.707), (0.707, -0.707), (0.707, -0.707), (0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (0.707, -0.707), (-0.707, 0.707), (-0.707, 0.707),
    }}};
    // Генерация PSS
    //std::vector<std::complex<double>> PSS = ofdm.generateZadoffChu(63, 25, true);

    // Обработка входных данных
    std::vector<std::complex<double>> output = ofdm.process(input_matrix, ofdm.ZadoffChu(true));

    // Печать выходных данных
    for (const auto &val : output) {
        std::cout << val << ",\n";
    }

    return 0;
}
